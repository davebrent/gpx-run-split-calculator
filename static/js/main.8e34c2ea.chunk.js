(this["webpackJsonpgpx-run-split-calculator"]=this["webpackJsonpgpx-run-split-calculator"]||[]).push([[0],{15:function(e,t,a){e.exports=a(26)},21:function(e,t,a){},23:function(e,t,a){},24:function(e,t,a){},26:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),l=a(11),i=a.n(l),s=(a(20),a(21),a(9)),o=a.n(s),c=a(14),u=a(12),p=a(2),m=a(5),h=a(6),d=a(8),f=a(7),v=function(){this.xmlSource="",this.metadata={},this.waypoints=[],this.tracks=[],this.routes=[]};v.prototype.parse=function(e){var t=new window.DOMParser;this.xmlSource=t.parseFromString(e,"text/xml");var a=this.xmlSource.querySelector("metadata");if(null!=a){this.metadata.name=this.getElementValue(a,"name"),this.metadata.desc=this.getElementValue(a,"desc"),this.metadata.time=this.getElementValue(a,"time");var r={},n=a.querySelector("author");if(null!=n){r.name=this.getElementValue(n,"name"),r.email={};var l=n.querySelector("email");null!=l&&(r.email.id=l.getAttribute("id"),r.email.domain=l.getAttribute("domain"));var i={},s=n.querySelector("link");null!=s&&(i.href=s.getAttribute("href"),i.text=this.getElementValue(s,"text"),i.type=this.getElementValue(s,"type")),r.link=i}this.metadata.author=r;var o={},c=this.queryDirectSelector(a,"link");null!=c&&(o.href=c.getAttribute("href"),o.text=this.getElementValue(c,"text"),o.type=this.getElementValue(c,"type"),this.metadata.link=o)}var u=[].slice.call(this.xmlSource.querySelectorAll("wpt"));for(var p in u){var m=u[p],h={};h.name=this.getElementValue(m,"name"),h.lat=parseFloat(m.getAttribute("lat")),h.lon=parseFloat(m.getAttribute("lon")),h.ele=parseFloat(this.getElementValue(m,"ele"))||null,h.cmt=this.getElementValue(m,"cmt"),h.desc=this.getElementValue(m,"desc"),this.waypoints.push(h)}var d=[].slice.call(this.xmlSource.querySelectorAll("rte"));for(var f in d){var v=d[f],y={};y.name=this.getElementValue(v,"name"),y.cmt=this.getElementValue(v,"cmt"),y.desc=this.getElementValue(v,"desc"),y.src=this.getElementValue(v,"src"),y.number=this.getElementValue(v,"number");var g=this.queryDirectSelector(v,"type");y.type=null!=g?g.innerHTML:null;var E={},b=v.querySelector("link");null!=b&&(E.href=b.getAttribute("href"),E.text=this.getElementValue(b,"text"),E.type=this.getElementValue(b,"type")),y.link=E;var k=[],S=[].slice.call(v.querySelectorAll("rtept"));for(var F in S){var V=S[F],D={};D.lat=parseFloat(V.getAttribute("lat")),D.lon=parseFloat(V.getAttribute("lon")),D.ele=parseFloat(this.getElementValue(V,"ele")),D.time=parseFloat(V.getAttribute("time")),k.push(D)}y.distance=this.calculDistance(k),y.elevation=this.calcElevation(k),y.points=k,this.routes.push(y)}var M=[].slice.call(this.xmlSource.querySelectorAll("trk"));for(var x in M){var _=M[x],A={};A.name=this.getElementValue(_,"name"),A.cmt=this.getElementValue(_,"cmt"),A.desc=this.getElementValue(_,"desc"),A.src=this.getElementValue(_,"src"),A.number=this.getElementValue(_,"number");var O=this.queryDirectSelector(_,"type");A.type=null!=O?O.innerHTML:null;var q={},N=_.querySelector("link");null!=N&&(q.href=N.getAttribute("href"),q.text=this.getElementValue(N,"text"),q.type=this.getElementValue(N,"type")),A.link=q;var j=[],w=[].slice.call(_.querySelectorAll("trkpt"));for(var K in w){var T=w[K],C={};C.lat=parseFloat(T.getAttribute("lat")),C.lon=parseFloat(T.getAttribute("lon")),C.ele=parseFloat(this.getElementValue(T,"ele"))||null,C.time=this.getElementValue(T,"time")||null,j.push(C)}A.distance=this.calculDistance(j),A.elevation=this.calcElevation(j),A.points=j,this.tracks.push(A)}},v.prototype.getElementValue=function(e,t){var a=e.querySelector(t);return null!=a?void 0!==a.innerHTML?a.innerHTML:a.childNodes[0].data:a},v.prototype.queryDirectSelector=function(e,t){var a=e.querySelectorAll(t),r=a[0];if(a.length>1){var n=e.childNodes;for(var l in n){var i=n[l];i.tagName===t&&(r=i)}}return r},v.prototype.calculDistance=function(e){for(var t={},a=0,r=[],n=0;n<e.length-1;n++)a+=this.calcDistanceBetween(e[n],e[n+1]),r[n]=a;return r[e.length-1]=a,t.total=a,t.cumul=r,t},v.prototype.calcDistanceBetween=function(e,t){var a={};a.lat=e.lat,a.lon=e.lon;var r={};r.lat=t.lat,r.lon=t.lon;var n=Math.PI/180,l=a.lat*n,i=r.lat*n,s=Math.sin((r.lat-a.lat)*n/2),o=Math.sin((r.lon-a.lon)*n/2),c=s*s+Math.cos(l)*Math.cos(i)*o*o;return 6371e3*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))},v.prototype.calcElevation=function(e){for(var t=0,a=0,r={},n=0;n<e.length-1;n++){var l=parseFloat(e[n+1].ele)-parseFloat(e[n].ele);l<0?a+=l:l>0&&(t+=l)}for(var i=[],s=0,o=0,c=e.length;o<c;o++){var u=parseFloat(e[o].ele);i.push(u),s+=u}return r.max=Math.max.apply(null,i)||null,r.min=Math.min.apply(null,i)||null,r.pos=Math.abs(t)||null,r.neg=Math.abs(a)||null,r.avg=s/i.length||null,r},v.prototype.toGeoJSON=function(){var e={type:"FeatureCollection",features:[],properties:{name:this.metadata.name,desc:this.metadata.desc,time:this.metadata.time,author:this.metadata.author,link:this.metadata.link}};for(var t in this.tracks){var a=this.tracks[t],r={type:"Feature",geometry:{type:"LineString",coordinates:[]},properties:{}};for(t in r.properties.name=a.name,r.properties.cmt=a.cmt,r.properties.desc=a.desc,r.properties.src=a.src,r.properties.number=a.number,r.properties.link=a.link,r.properties.type=a.type,a.points){var n=a.points[t],l=[];l.push(n.lon),l.push(n.lat),l.push(n.ele),r.geometry.coordinates.push(l)}e.features.push(r)}for(t in this.routes){var i=this.routes[t];for(t in(r={type:"Feature",geometry:{type:"LineString",coordinates:[]},properties:{}}).properties.name=i.name,r.properties.cmt=i.cmt,r.properties.desc=i.desc,r.properties.src=i.src,r.properties.number=i.number,r.properties.link=i.link,r.properties.type=i.type,i.points){var s=i.points[t];(l=[]).push(s.lon),l.push(s.lat),l.push(s.ele),r.geometry.coordinates.push(l)}e.features.push(r)}for(t in this.waypoints){var o=this.waypoints[t];(r={type:"Feature",geometry:{type:"Point",coordinates:[]},properties:{}}).properties.name=o.name,r.properties.cmt=o.cmt,r.properties.desc=o.desc,r.geometry.coordinates=[o.lon,o.lat,o.ele],e.features.push(r)}return e};var y=v,g=(a(23),a(24),function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"handleDrop",value:function(e){e.preventDefault(),this.props.onFilesDrop(e.dataTransfer.files)}},{key:"handleDragOver",value:function(e){e.preventDefault()}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"filedropper",onDrop:function(t){return e.handleDrop(t)},onDragOver:function(t){return e.handleDragOver(t)}},n.a.createElement("div",{className:"filedropper__text"},this.props.children))}}]),a}(n.a.Component)),E=a(13),b=a.n(E),k=a(3),S=D(1),F=D(5),V=D(10);function D(e){return 1.60934*e}function M(e,t,a){return(t-e)/(a-e)}function x(e){var t,a=[],r=0,n=(e=e.map((function(e){var t=e.lon,a=e.lat,r=e.ele,n=e.time;return{point:Object(k.point)([t,a]),time:Date.parse(n),elevation:r}})))[0],l=Object(p.a)(e);try{for(l.s();!(t=l.n()).done;){var i=t.value,s=i.time-e[0].time;r+=b()(n.point,i.point,{units:"kilometers"}),a.push({distance:r,elevation:i.elevation,time:s}),n=i}}catch(o){l.e(o)}finally{l.f()}return a}function _(e,t,a){var r,n,l,i,s,o,c=[],u=t,m=e[0],h=0,d=Object(p.a)(e);try{for(d.s();!(r=d.n()).done;){var f=r.value;if(!(f.distance<u)){var v=(n=m.distance,l=u,i=f.distance,s=m.time,o=f.time,s+(o-s)*M(n,l,i));c.push({time:v-h}),u+=t,h=v}}}catch(S){d.e(S)}finally{d.f()}var y=e[e.length-1];if(y.distance>=u-a){var g=M(m.distance,y.distance,u),E=1+(1-g)/g,b=y.time-m.time,k=m.time+b*E;c.push({time:k-h,estimated:!0,shortBy:1e3*(u-y.distance)})}return c}function A(e){return{oneKs:_(e,1,.05),oneMiles:_(e,S,.05),fiveKs:_(e,5,.05),fiveMiles:_(e,F,.05),tenKs:_(e,10,.05),tenMiles:_(e,V,.05),halfMarathons:_(e,21.0975,.05),marathons:_(e,42.195,.05),fiftyKs:_(e,50,.05)}}var O=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){var e;return Object(m.a)(this,a),(e=t.call(this)).state={active:null,files:[]},e}return Object(h.a)(a,[{key:"handleFiles",value:function(e){var t,a=this,r=this.state.files.length,n=Object(p.a)(e);try{var l=function(){var e=t.value;(i=new FileReader).readAsText(e,"utf-8"),i.onload=function(){var t=Object(u.a)(o.a.mark((function t(n){var l,i,s,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=new y;try{l.parse(n.target.result)}catch(o){}i={name:e.name,error:!1},l.tracks.length>=1?(s=x(l.tracks[0].points),u=A(s),i=Object.assign({},i,u)):i.error=!0,a.setState((function(e){return Object.assign({},e,{files:[].concat(Object(c.a)(e.files),[i]),active:r})}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};for(n.s();!(t=n.n()).done;){var i;l()}}catch(s){n.e(s)}finally{n.f()}}},{key:"handleFileClick",value:function(e){this.setState((function(t){return{active:e}}))}},{key:"renderFile",value:function(e,t){var a=this,r=this.state.active;return n.a.createElement("button",{className:"".concat("app__sidebar__file"," ").concat(t===r?"app__sidebar__file--active":""),key:"".concat(e.name,"-").concat(t),onClick:function(e){return a.handleFileClick(t)}},e.name)}},{key:"renderSplitsForDistance",value:function(e,t){if(0!==t.length){var a=0!==t.filter((function(e){return!0===e.estimated})).length;return n.a.createElement("div",{className:"distance"},n.a.createElement("h3",{className:"distance__header"},e),n.a.createElement("table",{className:"distance__table"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null),n.a.createElement("th",null,"Time"),a&&n.a.createElement("th",null,"Estimated"))),n.a.createElement("tbody",null,t.map((function(e,t){return n.a.createElement("tr",{key:t},n.a.createElement("td",null,t+1),n.a.createElement("td",null,function(e){var t=(e=(e-e%1e3)/1e3)%60,a=(e=(e-t)/60)%60,r=(e-a)/60;return(r=r.toString().padStart(2,"0"))+":"+(a=a.toString().padStart(2,"0"))+":"+(t=t.toString().padStart(2,"0"))}(e.time)),a&&n.a.createElement("td",null,function(e){if(e.estimated)return n.a.createElement("span",{className:"estimate"},"".concat(e.shortBy.toFixed(2)," meters"))}(e)))})))))}}},{key:"renderActiveFile",value:function(e){var t=this;return n.a.createElement("div",{className:"file"},n.a.createElement("h2",{className:"file__name"},e.name),!0===e.error?n.a.createElement("p",{className:"file__distances"},"File does not contain any tracks"):n.a.createElement("div",{className:"file__distances"},t.renderSplitsForDistance("1M",e.oneMiles),t.renderSplitsForDistance("5k",e.fiveKs),t.renderSplitsForDistance("10k",e.tenKs),t.renderSplitsForDistance("Half Marathon",e.halfMarathons),t.renderSplitsForDistance("Marathon",e.marathons),t.renderSplitsForDistance("50k",e.fiftyKs)))}},{key:"render",value:function(){var e=this,t=this.state,a=t.files,r=a[t.active];return n.a.createElement("div",{className:"app"},n.a.createElement("div",{className:"app__sidebar"},n.a.createElement(g,{onFilesDrop:function(t){return e.handleFiles(t)}},"Drop GPX files here"),a.map((function(t,a){return e.renderFile(t,a)}))),n.a.createElement("div",{className:"app__content"},r&&this.renderActiveFile(r)))}}]),a}(n.a.Component);i.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(O,null)),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.8e34c2ea.chunk.js.map